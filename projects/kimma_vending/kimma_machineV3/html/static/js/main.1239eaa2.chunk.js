(window.webpackJsonpvemiofrontpage=window.webpackJsonpvemiofrontpage||[]).push([[0],{337:function(e,t,n){e.exports=n(772)},342:function(e,t,n){},344:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},345:function(e,t,n){},368:function(e,t){},370:function(e,t){},402:function(e,t){},403:function(e,t){},446:function(e,t){},448:function(e,t){},470:function(e,t){},772:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(80),o=n.n(r),i=(n(342),n(28)),l=n.n(i),c=n(65),u=n(324),d=n(325),h=n(332),p=n(326),f=n(335),y=(n(344),n(345),n(333)),v=n(330),g=n(334),m=n(82),b=n.n(m),x=n(106),k=n(185),w=n.n(k),S=n(36),E=n.n(S),T=n(105),C=n.n(T),I=(n(638),9),P=5,D="Xbkt2mnNaKPQw1XEZknfTsnvN8bjZTgTHm",F="https://insight.dash.org/insight-api/tx/send",A={overlay:{transform:"rotate(90deg)",transformOrigin:"bottom left",position:"absolute",top:"-100vw",height:"100vw",width:"100vh"},modal:{minWidth:"300px",width:"500px"}},R=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={loading:!1,success:null,failed:null,dashQrCodeDisplay:null,dashAm:null,playSuccess:!1,playFailed:!1,playTx:!1,playClick:!1},n.generated=n.generateEverything(P,I),n.address=window.localStorage.getItem("address"),n.privKey=null!=window.localStorage.getItem("privKey")?new C.a.PrivateKey(window.localStorage.getItem("privKey")):null,null!=n.address&&null!=n.privKey||(n.privKey=new C.a.PrivateKey,n.address=n.privKey.toAddress(),window.localStorage.setItem("address",n.address.toString()),window.localStorage.setItem("privKey",n.privKey.toString())),n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"generateEverything",value:function(e,t){for(var n=[],a=0;a<e;a++)0==a?n.push(this.generateFirstRow(a,t)):n.push(this.generateRow(a,t));return s.a.createElement(v.a,{style:{height:"100%"}},s.a.createElement("tbody",null,n))}},{key:"generateFirstRow",value:function(e,t){var n=[];return n.push(this.generateCell(e,-1,2)),n.push(this.generateCell(e,1,2)),n.push(this.generateCell(e,3,1)),n.push(this.generateCell(e,5,2)),n.push(this.generateCell(e,7,2)),s.a.createElement("tr",{key:"row"+e},n)}},{key:"generateRow",value:function(e,t){for(var n=[],a=0;a<t;a++)n.push(this.generateCell(e,a,1));return s.a.createElement("tr",{key:"row"+e},n)}},{key:"generateCell",value:function(e,t,n){var a=this;return s.a.createElement("th",{key:"cell"+e+"-"+t,colSpan:n},s.a.createElement(y.a,{variant:"light",onClick:function(){a.buttonClicked.bind(a)(e,t)},style:{height:"140px"}},s.a.createElement("img",{src:"https://morebeer-web-8-pavinthewaysoftw.netdna-ssl.com/product_image/morebeer/500x500/27498.png",style:{width:"100%",height:"100%",objectFit:"contain"}})),s.a.createElement("p",{style:{textAlign:"center"}},.01," \u20ac"))}},{key:"txReceived",value:function(){var e=Object(c.a)(l.a.mark(function e(t,n,a,s){var r,o,i,c,u,d,h,p,f,y,v,g,m,x;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"GET",uri:"https://insight.dash.org/insight-api/tx/"+t,json:!0,resolveWithFullResponse:!0,simple:!1},e.next=3,b()(r);case 3:if(200==(o=e.sent).statusCode){e.next=6;break}return e.abrupt("return");case 6:i=-1,c=!0,u=!1,d=void 0,e.prev=10,h=o.body.vout[Symbol.iterator]();case 12:if(c=(p=h.next()).done){e.next=45;break}if(null==(f=p.value).scriptPubKey||null==f.scriptPubKey.addresses){e.next=42;break}y=!0,v=!1,g=void 0,e.prev=18,m=f.scriptPubKey.addresses[Symbol.iterator]();case 20:if(y=(x=m.next()).done){e.next=28;break}if(x.value!=this.address){e.next=25;break}return i=f.n,e.abrupt("break",28);case 25:y=!0,e.next=20;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(18),v=!0,g=e.t0;case 34:e.prev=34,e.prev=35,y||null==m.return||m.return();case 37:if(e.prev=37,!v){e.next=40;break}throw g;case 40:return e.finish(37);case 41:return e.finish(34);case 42:c=!0,e.next=12;break;case 45:e.next=51;break;case 47:e.prev=47,e.t1=e.catch(10),u=!0,d=e.t1;case 51:e.prev=51,e.prev=52,c||null==h.return||h.return();case 54:if(e.prev=54,!u){e.next=57;break}throw d;case 57:return e.finish(54);case 58:return e.finish(51);case 59:if(-1!==i){e.next=61;break}return e.abrupt("return");case 61:console.log("Response from GET: ",o.body),console.log("PAID!"),this.lastTx={txId:t,amount:n,outputIndex:i,scriptHex:o.body.vout[i].scriptPubKey.hex,fromAddress:o.body.vin[0].addr},this.sendRequest(a,s),this.cancelTransaction(),this.setState({playTx:!0,loading:!0,success:null,failed:null});case 67:case"end":return e.stop()}},e,this,[[10,47,51,59],[18,30,34,42],[35,,37,41],[52,,54,58]])}));return function(t,n,a,s){return e.apply(this,arguments)}}()},{key:"buttonClicked",value:function(){var e=Object(c.a)(l.a.mark(function e(t,n){var a,s=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.loading){e.next=2;break}return e.abrupt("return");case 2:return console.log("Clicked "+t+" "+n),this.setState({playClick:!0}),e.next=6,this.getDashQrCode(.01);case 6:if(null!=(a=e.sent)){e.next=10;break}return this.setState({loading:!1,success:null,failed:"Cannot fetch the exchange rate of DASH :(",dashQrCodeDisplay:null}),e.abrupt("return");case 10:this.socketInterval=setInterval(function(){s.cancelTransaction()},6e4),this.socket=window.io("http://insight.dash.org/"),this.socket.on("connect",function(){console.log("Connected to DASH network"),this.socket.emit("subscribe","inv")}.bind(this)),this.socket.on("txlock",function(e){if(e.txlock){if(console.log("New InstantSend transaction received: ",e),null!=e.vout){var s=!0,r=!1,o=void 0;try{for(var i,l=e.vout[Symbol.iterator]();!(s=(i=l.next()).done);s=!0){var c=i.value,u=Math.round(1e8*a.amount);if(console.log("OUT TX: ",c[D]),console.log("Desired TX: ",u),c[this.address]===u)return void this.txReceived(e.txid,u,t,n)}}catch(d){r=!0,o=d}finally{try{s||null==l.return||l.return()}finally{if(r)throw o}}}}else console.log("New transaction received: ",e)}.bind(this)),this.setState({loading:!1,success:null,failed:null,dashQrCodeDisplay:a.qrCode,dashAm:a.amount});case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDashQrCode",value:function(){var e=Object(c.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDashForEuro(t);case 2:if(null!=(n=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",{qrCode:"dash:"+this.address.toString()+"?amount="+n+"&label=Dash+For+Beer",amount:n});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"cancelTransaction",value:function(){this.setState({dashQrCodeDisplay:null}),this.socket.disconnect(),clearInterval(this.socketInterval)}},{key:"getDashForEuro",value:function(){var e=Object(c.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"GET",uri:"https://rates2.dashretail.org/rates?source=dashretail&symbol=dasheur",json:!0,resolveWithFullResponse:!0,simple:!1},e.next=3,b()(n);case 3:if(a=e.sent,console.log("response body: ",a.body),200==a.statusCode&&null!=a.body&&0!=a.body.length&&null!=a.body[0]&&null!=a.body[0].price){e.next=8;break}return console.log("Error fetching exchange rate of DASH"),e.abrupt("return",null);case 8:return e.abrupt("return",Math.floor(t/parseFloat(a.body[0].price)*1e8)/1e8);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"vendSuccess",value:function(){var e=Object(c.a)(l.a.mark(function e(){var t,n,a,s,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.lastTx){e.next=12;break}return t={txId:this.lastTx.txId,outputIndex:this.lastTx.outputIndex,address:this.address,script:this.lastTx.scriptHex,satoshis:this.lastTx.amount},console.log("UTXO created: ",t),n=(new C.a.Transaction).from(t).to(D,this.lastTx.amount-200).sign(this.privKey).fee(200),a=n.serialize(),s={method:"POST",uri:F,body:{rawtx:a},json:!0,resolveWithFullResponse:!0,simple:!1},e.next=8,b()(s);case 8:r=e.sent,console.log("Response body: ",r.body),console.log("Status code: ",r.statusCode),r.statusCode;case 12:return this.setState({playSuccess:!0,loading:!1,success:"Here's your beer :)"}),e.abrupt("return");case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"vendFailed",value:function(){var e=Object(c.a)(l.a.mark(function e(){var t,n,a,r,o,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,null==this.lastTx){e.next=15;break}return n={txId:this.lastTx.txId,outputIndex:this.lastTx.outputIndex,address:this.address,script:this.lastTx.scriptHex,satoshis:this.lastTx.amount},console.log("UTXO created: ",n),a=(new C.a.Transaction).from(n).to(this.lastTx.fromAddress,this.lastTx.amount-200).sign(this.privKey).fee(200),console.log("TX created"),r=a.toString(),console.log("TX serialize: ",r),o={method:"POST",uri:F,body:{rawtx:r},json:!0,resolveWithFullResponse:!0,simple:!1},e.next=11,b()(o);case 11:i=e.sent,console.log("Response body: ",i.body),console.log("Status code: ",i.statusCode),200===i.statusCode&&(t=i.body.txid);case 15:this.setState({playFailed:!0,loading:!1,failed:s.a.createElement("p",null,"We are really sorry, something didn't go well. Don't worry, your transaction has been refunded, you can check the status here:",s.a.createElement("br",null),s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(w.a,{value:"https://blockchair.com/dash/transaction/"+t,size:256})))});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendRequest",value:function(){var e=Object(c.a)(l.a.mark(function e(t,n){var a,s,r,o,i,c,u=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"GET",uri:"http://192.168.1.102/process_donation.bin?x="+(n+1)+"&y="+(5-t),json:!0,resolveWithFullResponse:!0,simple:!1,timeout:10},s=b()(a),r=setInterval(function(){s.abort(),u.vendFailed(),clearInterval(r)},1e4),e.next=5,s;case 5:if(o=e.sent,clearInterval(r),200!==o.statusCode){e.next=21;break}if(console.log(o.body),!((i=o.body.split("\n")).length>1)){e.next=19;break}if(console.log("ARR: "+i[1]),!((c=i[1].split(":")).length>1)){e.next=19;break}if(console.log("ARR21: "+c[0]),console.log("ARR22: "+c[1]),"message"!=c[0]||"SUCCESS"!=c[1]){e.next=19;break}return this.vendSuccess(),e.abrupt("return");case 19:return this.vendFailed(),e.abrupt("return");case 21:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"wrapper"},s.a.createElement("div",{style:{width:"100%",height:"100%"}},s.a.createElement(E.a,{url:"./txIn.mp3",playStatus:this.state.playTx?E.a.status.PLAYING:E.a.status.STOPPED,onFinishedPlaying:function(){e.setState({playTx:!1})}}),s.a.createElement(E.a,{url:"./sound-effect-tada.mp3",playStatus:this.state.playSuccess?E.a.status.PLAYING:E.a.status.STOPPED,onFinishedPlaying:function(){e.setState({playSuccess:!1})}}),s.a.createElement(E.a,{url:"./fail-sound-effect.mp3",playStatus:this.state.playFailed?E.a.status.PLAYING:E.a.status.STOPPED,onFinishedPlaying:function(){e.setState({playFailed:!1})}}),s.a.createElement(E.a,{url:"./clickSound.wav",playStatus:this.state.playClick?E.a.status.PLAYING:E.a.status.STOPPED,onFinishedPlaying:function(){e.setState({playClick:!1})}}),s.a.createElement(x.a,{open:null!=this.state.failed,styles:A,center:!0,onClose:function(){e.setState({failed:null})},focusTrapped:!1},s.a.createElement("h2",null,"Failed!"),s.a.createElement("p",null,this.state.failed)),s.a.createElement(x.a,{open:null!=this.state.success,styles:A,center:!0,onClose:function(){e.setState({success:null})},focusTrapped:!1},s.a.createElement("h2",null,"Success!"),s.a.createElement("p",null,this.state.success)),s.a.createElement(x.a,{open:this.state.loading,styles:A,center:!0,showCloseIcon:!1,onClose:function(){},focusTrapped:!1},s.a.createElement("h2",null,"Processing..."),s.a.createElement("p",null,"Dispensing your beer, please wait! :)"),s.a.createElement(g.a,{animated:!0,now:100})),s.a.createElement(x.a,{open:null!=this.state.dashQrCodeDisplay,styles:A,center:!0,onClose:this.cancelTransaction.bind(this),focusTrapped:!1},s.a.createElement("h2",{style:{textAlign:"center"}},"Please scan the QR code!"),s.a.createElement("div",{style:{textAlign:"center"}},s.a.createElement(w.a,{value:null!=this.state.dashQrCodeDisplay?this.state.dashQrCodeDisplay:"",size:256})),s.a.createElement("h3",{style:{textAlign:"center"}},this.state.dashAm," DASH")),this.generated))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[337,1,2]]]);
//# sourceMappingURL=main.1239eaa2.chunk.js.map